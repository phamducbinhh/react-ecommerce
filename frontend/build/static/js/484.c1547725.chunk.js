"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[484],{8255:function(e,r,n){n(2791);var i=n(184);r.Z=function(){return(0,i.jsx)("div",{className:"section secton-center",children:(0,i.jsx)("div",{className:"loading"})})}},1997:function(e,r,n){n.d(r,{Z:function(){return t}});var i=n(5572),s=n(184);function t(e){return(0,s.jsx)(i.Z,{variant:e.variant||"info",children:e.children})}},9864:function(e,r,n){n.d(r,{E:function(){return t},I:function(){return s}});var i=n(1413),s=function(e,r){switch(r.type){case"FETCH_REQUEST":return(0,i.Z)((0,i.Z)({},e),{},{loading:!0,error:""});case"FETCH_SUCCESS":return(0,i.Z)((0,i.Z)({},e),{},{loading:!1,order:r.payload,error:""});case"FETCH_FAIL":return(0,i.Z)((0,i.Z)({},e),{},{loading:!1,error:r.payload});case"PAY_REQUEST":return(0,i.Z)((0,i.Z)({},e),{},{loadingPay:!0});case"PAY_SUCCESS":return(0,i.Z)((0,i.Z)({},e),{},{loadingPay:!1,successPay:!0});case"PAY_FAIL":return(0,i.Z)((0,i.Z)({},e),{},{loadingPay:!1});case"PAY_RESET":return(0,i.Z)((0,i.Z)({},e),{},{loadingPay:!1,successPay:!1});case"DELIVER_REQUEST":return(0,i.Z)((0,i.Z)({},e),{},{loadingDeliver:!0});case"DELIVER_SUCCESS":return(0,i.Z)((0,i.Z)({},e),{},{loadingDeliver:!1,successDeliver:!0});case"DELIVER_FAIL":return(0,i.Z)((0,i.Z)({},e),{},{loadingDeliver:!1});case"DELIVER_RESET":return(0,i.Z)((0,i.Z)({},e),{},{loadingDeliver:!1,successDeliver:!1});default:return e}},t={loading:!0,order:{},error:"",successPay:!1,loadingPay:!1}},9484:function(e,r,n){n.r(r),n.d(r,{default:function(){return b}});var i,s=n(8214),t=n(5861),a=n(885),c=n(168),d=n(4569),o=n.n(d),l=n(2791),u=n(9743),h=n(2677),p=n(2144),x=n(6871),Z=n(1687),j=n(8255),g=n(1997),v=n(8419),f=n(9864),y=n(6444),E=n(184),m=function(e){var r=e.order;return(0,E.jsxs)(p.Z.Body,{children:[(0,E.jsx)(p.Z.Title,{children:"\u0110\u01a1n H\xe0ng"}),(0,E.jsxs)(p.Z.Text,{children:[(0,E.jsx)("strong",{children:"S\u1ea3n Ph\u1ea9m:"})," ",r.shippingAddress.fullName," ",(0,E.jsx)("br",{}),(0,E.jsx)("strong",{children:"\u0110\u1ecba Ch\u1ec9: "})," ",r.shippingAddress.address,r.shippingAddress.city,", ",r.shippingAddress.postalCode,",",r.shippingAddress.country]}),r.isDelivered?(0,E.jsxs)(g.Z,{variant:"success",children:["\u0110ang Giao H\xe0ng ",r.deliveredAt]}):(0,E.jsx)(g.Z,{variant:"danger",children:"Ch\u01b0a Giao H\xe0ng"})]})},P=function(e){var r=e.order;return(0,E.jsxs)(p.Z.Body,{children:[(0,E.jsx)(p.Z.Title,{children:"Thanh To\xe1n"}),(0,E.jsxs)(p.Z.Text,{children:[(0,E.jsx)("strong",{children:"Ph\u01b0\u01a1ng Th\u1ee9c:"})," ",r.paymentMethod]}),r.isPaid?(0,E.jsxs)(g.Z,{variant:"success",children:["\u0110\xe3 Thanh To\xe1n ",r.paidAt]}):(0,E.jsx)(g.Z,{variant:"danger",children:"Ch\u01b0a Thanh To\xe1n"})]})},T=n(4414),S=n(3504),_=function(e){var r=e.order;return(0,E.jsxs)(p.Z.Body,{children:[(0,E.jsx)(p.Z.Title,{children:"S\u1ea3n Ph\u1ea9m"}),(0,E.jsx)(T.Z,{variant:"flush",children:r.orderItems.map((function(e){return(0,E.jsx)(T.Z.Item,{children:(0,E.jsxs)(u.Z,{className:"align-items-center",children:[(0,E.jsxs)(h.Z,{md:6,children:[(0,E.jsx)("img",{src:e.image,alt:e.name,className:"image"})," ",(0,E.jsx)(S.Link,{to:"/product/".concat(e.slug),children:e.name})]}),(0,E.jsx)(h.Z,{md:3,children:(0,E.jsx)("span",{children:e.quantity})}),(0,E.jsxs)(h.Z,{md:3,children:["$",e.price]})]})},e._id)}))})]})},C=n(1299),A=n(8412),I=function(e){var r=e.order,n=e.isPending,i=e.loadingPay,s=e.createOrder,t=e.onApprove,a=e.onError,c=e.deliverOrderHandler,d=e.loadingDeliver,o=(0,Z.o)().state.userInfo;return(0,E.jsxs)(p.Z.Body,{children:[(0,E.jsx)(p.Z.Title,{children:"Th\xe0nh Ti\u1ec1n"}),(0,E.jsxs)(T.Z,{variant:"flush",children:[(0,E.jsx)(T.Z.Item,{children:(0,E.jsxs)(u.Z,{children:[(0,E.jsx)(h.Z,{children:"Ti\u1ec1n h\xe0ng"}),(0,E.jsxs)(h.Z,{children:["$",r.itemsPrice.toFixed(2)]})]})}),(0,E.jsx)(T.Z.Item,{children:(0,E.jsxs)(u.Z,{children:[(0,E.jsx)(h.Z,{children:"Ph\xed v\u1eadn chuy\u1ec3n"}),(0,E.jsxs)(h.Z,{children:["$",r.shippingPrice.toFixed(2)]})]})}),(0,E.jsx)(T.Z.Item,{children:(0,E.jsxs)(u.Z,{children:[(0,E.jsx)(h.Z,{children:"Thu\u1ebf"}),(0,E.jsxs)(h.Z,{children:["$",r.taxPrice.toFixed(2)]})]})}),(0,E.jsx)(T.Z.Item,{children:(0,E.jsxs)(u.Z,{children:[(0,E.jsx)(h.Z,{children:(0,E.jsx)("strong",{children:"T\u1ed5ng c\u1ed9ng"})}),(0,E.jsx)(h.Z,{children:(0,E.jsxs)("strong",{children:["$",r.totalPrice.toFixed(2)]})})]})}),!r.isPaid&&(0,E.jsxs)(T.Z.Item,{children:[n?(0,E.jsx)(j.Z,{}):(0,E.jsx)("div",{children:(0,E.jsx)(C.ch,{createOrder:s,onApprove:t,onError:a})}),i&&(0,E.jsx)(j.Z,{})]}),o.isAdmin&&r.isPaid&&!r.isDelivered&&(0,E.jsx)(T.Z.Item,{children:(0,E.jsx)("div",{className:"d-grid",children:(0,E.jsx)(A.Z,{type:"button",kind:"ghost",onClick:c,isLoading:d,children:"X\xe1c Nh\u1eadn Giao H\xe0ng"})})})]})]})},D=n(1830),k=n.n(D),R=n(3298),F=n(9085),L=y.ZP.div(i||(i=(0,c.Z)(["\n  min-height: 100vh;\n  padding: 40px;\n  .image {\n    width: 50px;\n    height: 50px;\n    object-fit: cover;\n  }\n"]))),b=function(){var e=(0,Z.o)().state.userInfo,r=(0,x.UO)().id,n=(0,x.s0)(),i=(0,l.useReducer)(f.I,f.E),c=(0,a.Z)(i,2),d=c[0],y=d.loading,T=d.error,S=d.order,A=d.successPay,D=d.loadingPay,b=d.loadingDeliver,U=d.successDeliver,w=c[1],H=(0,C.Up)(),N=(0,a.Z)(H,2),B=N[0].isPending,V=N[1];(0,l.useEffect)((function(){var i=function(){var n=(0,t.Z)((0,s.Z)().mark((function n(){var i,t;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,w({type:"FETCH_REQUEST"}),n.next=4,o().get("/api/orders/".concat(r),{headers:{authorization:"Bearer ".concat(e.token)}});case 4:i=n.sent,t=i.data,w({type:"FETCH_SUCCESS",payload:t}),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),w({type:"FETCH_FAIL",payload:(0,v.by)(n.t0)});case 12:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(){return n.apply(this,arguments)}}();if(!e)return n("/signin");if(!S._id||A||U||S._id&&S._id!==r)i(),A&&w({type:"PAY_RESET"}),U&&w({type:"DELIVER_RESET"});else{var a=function(){var r=(0,t.Z)((0,s.Z)().mark((function r(){var n,i;return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o().get("/api/keys/paypal",{headers:{authorization:"Bearer ".concat(e.token)}});case 2:n=r.sent,i=n.data,V({type:"resetOptions",value:{"client-id":i,currency:"USD"}}),V({type:"setLoadingStatus",value:"pending"});case 6:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();a()}}),[S,e,r,n,V,A,U]);var Y=function(){var r=(0,t.Z)((0,s.Z)().mark((function r(){var n,i;return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,w({type:"DELIVER_REQUEST"}),r.next=4,o().put("/api/orders/".concat(S._id,"/deliver"),{},{headers:{authorization:"Bearer ".concat(e.token)}});case 4:n=r.sent,i=n.data,w({type:"DELIVER_SUCCESS",payload:i}),k().fire("S\u1ea3n Ph\u1ea9m M\u1edbi!","Giao H\xe0ng Th\xe0nh C\xf4ng","success"),r.next=14;break;case 10:r.prev=10,r.t0=r.catch(0),F.Am.error((0,v.by)(r.t0)),w({type:"DELIVER_FAIL"});case 14:case"end":return r.stop()}}),r,null,[[0,10]])})));return function(){return r.apply(this,arguments)}}();return y?(0,E.jsx)(j.Z,{}):T?(0,E.jsx)(g.Z,{variant:"danger",children:T}):(0,E.jsxs)(L,{children:[(0,E.jsxs)(R.Z,{children:["\u0110\u01a1n H\xe0ng ",r]}),(0,E.jsxs)(u.Z,{children:[(0,E.jsxs)(h.Z,{md:8,children:[(0,E.jsx)(p.Z,{className:"mb-3",children:(0,E.jsx)(m,{order:S})}),(0,E.jsx)(p.Z,{className:"mb-3",children:(0,E.jsx)(P,{order:S})}),(0,E.jsx)(p.Z,{className:"mb-3",children:(0,E.jsx)(_,{order:S})})]}),(0,E.jsx)(h.Z,{md:4,children:(0,E.jsx)(p.Z,{className:"mb-3",children:(0,E.jsx)(I,{order:S,isPending:B,loadingPay:D,createOrder:function(e,r){return r.order.create({purchase_units:[{amount:{value:S.totalPrice}}]}).then((function(e){return e}))},onApprove:function(r,n){return n.order.capture().then(function(){var r=(0,t.Z)((0,s.Z)().mark((function r(n){var i,t;return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,w({type:"PAY_REQUEST"}),r.next=4,o().put("/api/orders/".concat(S._id,"/pay"),n,{headers:{authorization:"Bearer ".concat(e.token)}});case 4:i=r.sent,t=i.data,w({type:"PAY_SUCCESS",payload:t}),k().fire({position:"center",icon:"success",title:"Th\xe0nh C\xf4ng",showConfirmButton:!1,timer:1500}),r.next=14;break;case 10:r.prev=10,r.t0=r.catch(0),w({type:"PAY_FAIL",payload:(0,v.by)(r.t0)}),k().fire("Failed","error","warning");case 14:case"end":return r.stop()}}),r,null,[[0,10]])})));return function(e){return r.apply(this,arguments)}}())},onError:function(e){console.log((0,v.by)(e))},deliverOrderHandler:Y,loadingDeliver:b})})})]})]})}}}]);
//# sourceMappingURL=484.c1547725.chunk.js.map